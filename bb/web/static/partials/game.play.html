<div class="game-free" ng-if="!loading">
    <div class="scoreboard">
        <div class="row scoreboard-content">
            <div>
                <div class="emblem col-xs-4 text-right">
                    <div class="gamelabel">
                        Home
                    </div>
                    <div>
                        {{game.home_team.name}}
                    </div>
                    <div class="rerolls">
                        <div ng-repeat="n in [] | range:8" title="{{ 7-$index < game.state.home_state.rerolls ? 'Reroll' : (7-$index < game.state.home_state.rerolls_start ? 'Reroll used' : '') }}" class="reroll home {{ 7-$index < game.state.home_state.rerolls ? 'notused' : (7-$index < game.state.home_state.rerolls_start ? 'used' : 'none') }}"> </div>
                    </div>
                </div>
                <div class="col-xs-1 logo-home text-center">
                    <img src="static/img/teamlogos/{{game.home_team.race.toLowerCase()}}.gif" height="64" width="64" />
                </div>
                <div class="col-xs-2 no-padding">
                    <div class="text-center">
                        <div class="gamelabel">Score</div>
                        <div>{{game.state.home_state.score}} - {{game.state.away_state.score}}</div>
                    </div>
                    <div class="text-center" style="margin-top: -5px;">
                        <div class="team-icons">
                            <span><img src="static/img/weather/{{game.state.weather.toLowerCase()}}.gif" title="Weather is {{ game.state.weather.toLowerCase().replace('_', ' ')}}" width="20px" height="20px" /></span>
                        </div>
                    </div>
                </div>
                <div class="col-xs-1 logo-away text-center">
                    <div>
                        <img src="static/img/teamlogos/{{game.away_team.race.toLowerCase()}}.gif" height="64" width="64" />
                    </div>
                </div>
                <div class="emblem col-xs-4 text-left">
                    <div class="gamelabel">
                        Away
                    </div>
                    <div>
                        {{game.away_team.name}}
                    </div>
                    <div class="rerolls">
                        <div ng-repeat="n in [] | range:8" title="{{ $index < game.state.away_state.rerolls ? 'Reroll' : ($index < game.state.away_state.rerolls_start ? 'Reroll used' : '') }}" class="reroll away {{ $index < game.state.away_state.rerolls ? 'notused' : ($index < game.state.away_state.rerolls_start ? 'used' : 'none') }}"> </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row scoreboard-content">
            <div class="col-xs-4">
                <div class="team-icons text-right">
                    <span class="team-icon"><img src="static/img/team_status/wizard.gif" class="{{ game.state.home_state.wizard_available ? 'available' : 'used' }}" title="Wizard {{ game.state.home_state.wizard_available ? 'ready' : 'not available' }}" width="20px" height="20px" /></span>
                    <span class="team-icon"><img src="static/img/team_status/apoth.gif" class="{{ game.state.home_state.apothecary_available ? 'available' : 'used' }}" title="Apothecary {{ game.state.home_state.apothecary_available ? 'ready' : 'not available' }}" width="20px" height="20px" /></span>
                </div>
            </div>
            <div class="col-xs-1 text-center {{ game.state.team_turn == true ? 'bold' : '' }}">
                <div class="proclabel" ng-if="game.state.home_state.turn != null">{{ game.state.home_state.turn }} / 8</div>
            </div>
            <div class="col-xs-2 text-center">
                <div class="proclabel">{{ currentProc(true) }}</div>
            </div>
            <div class="col-xs-1 text-center {{ game.state.team_turn == false ? 'bold' : '' }}">
                <div class="proclabel" ng-if="game.state.away_state.turn != null">{{ game.state.away_state.turn }} / 8</div>
            </div>
            <div class="col-xs-4">
                <div class="team-icons">
                    <span class="team-icon"><img src="static/img/team_status/apoth.gif" class="{{ game.state.away_state.apothecary_available ? 'available' : 'used' }}" title="Apothecary {{ game.state.away_state.apothecary_available ? 'ready' : 'not available' }}" width="20px" height="20px" /></span>
                    <span class="team-icon"><img src="static/img/team_status/wizard.gif" class="{{ game.state.away_state.wizard_available ? 'available' : 'used' }}" title="Wizard {{ game.state.away_state.wizard_available ? 'ready' : 'not available' }}" width="20px" height="20px" /></span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6 turnmarker {{ game.state.team_turn == true ? 'turnmarker-home-turn' : 'turnmarker-home' }}"></div>
            <div class="col-sm-6 turnmarker {{ game.state.team_turn == false ? 'turnmarker-away-turn' : 'turnmarker-away' }}"></div>
        </div>
    </div>
</div>

<div class="game-free" ng-if="!loading">

    <div class="gamecontent">

        <div class="square-row">
            <div class="square" ng-repeat="n in [] | range:30" ng-click="square('crowd', $index-1, 0)"></div>
        </div>

        <div class="gameboard">
            <div class="dugout home">
                <div class="square-row" ng-repeat="n in [] | range:15">
                    <div class="square home {{ $index < 8 ? '' : ($index < 12 ? 'kod' : 'casualties' ) }} {{ local_state.home_dugout[$index][0].selected ? 'selected' : '' }} {{ local_state.home_dugout[$index][0].available_position ? 'green' : '' }}" ng-click="square(local_state.home_dugout[$index][0])" ng-mouseover="squareHover(local_state.home_dugout[$index][0])">
                        <div class="playericon align-middle text-center" ng-if="local_state.home_dugout[$index][0].player != null">
                            <img src="static/img/iconssmall/{{ local_state.home_dugout[$index][0].player_icon }}" />
                        </div>
                    </div>
                    <div class="square home {{ $index < 8 ? '' : ($index < 12 ? 'kod' : 'casualties' ) }} {{ local_state.home_dugout[$index][1].selected ? 'selected' : ''}} {{ local_state.home_dugout[$index][1].available_position ? 'green' : '' }}" ng-click="square(local_state.home_dugout[$index][1])" ng-mouseover="squareHover(local_state.home_dugout[$index][1])">
                        <div class="playericon align-middle text-center" ng-if="local_state.home_dugout[$index][1].player != null">
                            <img src="static/img/iconssmall/{{ local_state.home_dugout[$index][1].player_icon }}" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="field {{ game.state.weather.toLowerCase().replace('_','') }}">
                <div class="square-row" ng-repeat="row in game.state.field.board.slice(1, game.state.field.board.length-1)">
                    <div class="square {{ local_state.board[$parent.$index+1][$index+1].selected ? 'selected' : '' }} {{ local_state.board[$parent.$index+1][$index+1].available_position ? 'green' : '' }}" ng-repeat="n in [] | range:row.length-2" ng-click="square(local_state.board[$parent.$index+1][$index+1])" ng-mouseover="squareHover(local_state.board[$parent.$index+1][$index+1])">
                        <div class="playericon align-middle text-center" ng-if="local_state.board[$parent.$index+1][$index+1].player != null">
                            <img src="static/img/iconssmall/{{ local_state.board[$parent.$parent.$index+1][$index+1].player_icon }}" />
                        </div>
                        <div class="ballicon align-middle text-center" ng-if="local_state.board[$parent.$index+1][$index+1].ball">
                            <img ng-if="local_state.ball_in_air" src="static/img/ball/sball_30x30.png" />
                            <img ng-if="!local_state.ball_in_air" src="static/img/ball/sball_30x30.png" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="dugout away">
                <div class="square-row" ng-repeat="n in [] | range:15">
                    <div class="square away {{ $index < 8 ? '' : ($index < 12 ? 'kod' : 'casualties' ) }}  {{ local_state.away_dugout[$index][0].selected ? 'selected' : ''}} {{ local_state.away_dugout[$index][0].available_position ? 'green' : '' }}" ng-click="square(local_state.away_dugout[$index][0])" ng-mouseover="squareHover(local_state.away_dugout[$index][0])">
                        <div class="playericon align-middle text-center" ng-if="local_state.away_dugout[$index][0].player != null">
                            <img src="static/img/iconssmall/{{ local_state.away_dugout[$index][0].player_icon }}" />
                        </div>
                    </div>
                    <div class="square away {{ $index < 8 ? '' : ($index < 12 ? 'kod' : 'casualties' ) }}  {{ local_state.away_dugout[$index][1].selected ? 'selected' : ''}} {{ local_state.away_dugout[$index][1].available_position ? 'green' : '' }}" ng-click="square(local_state.away_dugout[$index][1])" ng-mouseover="squareHover(local_state.away_dugout[$index][1])">
                        <div class="playericon align-middle text-center" ng-if="local_state.away_dugout[$index][1].player != null">
                            <img src="static/img/iconssmall/{{ local_state.away_dugout[$index][1].player_icon }}" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="square-row">
            <div class="square" ng-repeat="n in [] | range:30" ng-click="square('crowd', $index-1, 16)"></div>
        </div>

        <div class="game-info">
            <div class="player-info">
                <div class="home team-box" ng-if="playerInFocus(game.home_team) != null">
                    <div class="icon-box red">
                        <img src="static/img/iconssmall/{{ playerIcon(playerInFocus(game.home_team), false) }}" width="48px" height="48px" />
                    </div>
                    <div class="stats-box left">
                        <span class="name-box">
                            {{playerInFocus(game.home_team).nr}}. <b>{{playerInFocus(game.home_team).position_name}}:</b> {{playerInFocus(game.home_team).name}}
                        </span>
                        <div>
                            <div class="attribute text-center">
                                <div class="gamelabel">MA</div>
                                <div class="value label label-success red">{{playerInFocus(game.home_team).ma}}</div>
                            </div>
                            <div class="attribute text-center">
                                <div class="gamelabel">ST</div>
                                <div class="value label label-success red">{{playerInFocus(game.home_team).st}}</div>
                            </div>
                            <div class="attribute text-center">
                                <div class="gamelabel">AG</div>
                                <div class="value label label-success red">{{playerInFocus(game.home_team).ag}}</div>
                            </div>
                            <div class="attribute text-center">
                                <div class="gamelabel">AV</div>
                                <div class="value label label-success red">{{playerInFocus(game.home_team).av}}</div>
                            </div>
                            <div class="attribute">
                                <div class="gamelabel">Skills</div>
                                <div><span class="label label-success skill" ng-repeat="skill in playerInFocus(game.home_team).skills">{{ prettify(skill) }}</span>&nbsp</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="away team-box" ng-if="playerInFocus(game.away_team) != null">
                    <div class="icon-box blue">
                        <img src="static/img/iconssmall/{{ playerIcon(playerInFocus(game.away_team), false) }}" width="48px" height="48px" />
                    </div>
                    <div class="stats-box">
                        <div>
                            <span class="name-box">
                                {{playerInFocus(game.away_team).nr}}. <b>{{playerInFocus(game.away_team).position_name}}:</b> {{playerInFocus(game.away_team).name}}
                            </span>
                        </div>
                        <div>
                            <div class="attribute text-center">
                                <div class="gamelabel">MA</div>
                                <div class="value label label-success blue">{{playerInFocus(game.away_team).ma}}</div>
                            </div>
                            <div class="attribute text-center">
                                <div class="gamelabel">ST</div>
                                <div class="value label label-success blue">{{playerInFocus(game.away_team).st}}</div>
                            </div>
                            <div class="attribute text-center">
                                <div class="gamelabel">AG</div>
                                <div class="value label label-success blue">{{playerInFocus(game.away_team).ag}}</div>
                            </div>
                            <div class="attribute text-center">
                                <div class="gamelabel">AV</div>
                                <div class="value label label-success blue">{{playerInFocus(game.away_team).av}}</div>
                            </div>
                            <div class="attribute">
                                <div class="gamelabel">Skills</div>
                                <div><span class="label label-success skill" ng-repeat="skill in playerInFocus(game.away_team).skills">{{ prettify(skill) }}</span>&nbsp</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="action-bar text-center">
                <span ng-repeat="action in game.available_actions">
                    <button ng-if="showAction(action)" type="button" class="btn btn-sm {{action.team == null ? 'btn-default' : (action.team ? 'btn-danger' : 'btn-primary')}}" ng-click="pickActionType(action)" ng-disabled="refreshing">
                        {{ prettify(action.action_type) }}
                    </button>
                </span>
            </div>
            <textarea class="form-control" rows="5" id="gamelog" disabled>{{ gamelog }}</textarea>
        </div>

    </div>

</div>
